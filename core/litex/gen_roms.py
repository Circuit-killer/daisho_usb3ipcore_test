from litex.gen import *
from litex.gen.fhdl import verilog

# usb2_descrip

usb2_descriptor = [
# device
0x12, 0x01, 0x10, 0x02, 0xff, 0xff, 0xff, 0x40,
0x50, 0x1d, 0x5a, 0x60, 0x01, 0x00, 0x01, 0x02,
0x03, 0x01,
# config
0x0a, 0x06, 0x10, 0x02, 0xff, 0xff, 0xff, 0x40,
0x01, 0x00, 0x09, 0x02, 0x29, 0x00, 0x01, 0x01,
0x00, 0x80, 0x3e, 0x09, 0x04, 0x00, 0x00, 0x02,
0xff, 0xff, 0xff, 0x02, 0x07, 0x05, 0x81, 0x02,
0x00, 0x02, 0x01, 0x07, 0x05, 0x02, 0x02, 0x00,
0x02, 0x01, 0x09, 0x04, 0x00, 0x01, 0x00, 0xff,
0xff, 0xff, 0x02,
# string0
0x04, 0x03, 0x09, 0x04,
# string1
0x28, 0x03, 0x47, 0x00, 0x72, 0x00, 0x65, 0x00,
0x61, 0x00, 0x74, 0x00, 0x20, 0x00, 0x53, 0x00,
0x63, 0x00, 0x6f, 0x00, 0x74, 0x00, 0x74, 0x00,
0x20, 0x00, 0x47, 0x00, 0x61, 0x00, 0x64, 0x00,
0x67, 0x00, 0x65, 0x00, 0x74, 0x00, 0x73, 0x00,
# string2
0x20, 0x03, 0x44, 0x00, 0x61, 0x00, 0x69, 0x00,
0x73, 0x00, 0x68, 0x00, 0x6f, 0x00, 0x20, 0x00,
0x55, 0x00, 0x53, 0x00, 0x42, 0x00, 0x20, 0x00,
0x74, 0x00, 0x65, 0x00, 0x73, 0x00, 0x74, 0x00,
# string3
0x1A, 0x03, 0x44, 0x00, 0x41, 0x00, 0x49, 0x00,
0x53, 0x00, 0x48, 0x00, 0x4F, 0x00, 0x55, 0x00,
0x53, 0x00, 0x42, 0x00, 0x30, 0x00, 0x30, 0x00,
0x30, 0x00, 
# confunset 
0x00,
# confset 
0x01,
#eof
]

class USB2Descriptor(Module):
    def __init__(self):
        self.specials.mem = Memory(8, 256, init=usb2_descriptor)
        p = self.mem.get_port()
        self.specials += p
        self.ios = {p.adr, p.dat_r}

usb2_descrip = USB2Descriptor()
conv_output = verilog.convert(usb2_descrip, usb2_descrip.ios, name="usb2_descrip")
conv_output.write("usb2_descrip.v")


# usb3_descrip

usb3_descriptor = [
# device
0x12010003,
0xffffff09,
0x501d5a60,
0x01000102,
0x03010000,
# config
0x09023500,
0x01010080,
0x3e090400,
0x0002ffff,
0xff020705,
0x81020004,
0x0106300f,
0x00000007,
0x05020200,
0x04010630,
0x0f000000,
0x09040001,
0x00ffffff,
0x02000000,
# bos
0x050f1600,
0x02071002,
0x02000000,
0x0a100300,
0x0e000208,
0x64000004,
# string0 
0x04030904,
# string1
0x28034700,
0x72006500,
0x61007400,
0x20005300,
0x63006f00,
0x74007400,
0x20004700,
0x61006400,
0x67006500,
0x74007300,
# string2
0x20034400,
0x61006900,
0x73006800,
0x6f002000,
0x55005300,
0x42002000,
0x74006500,
0x73007400,
# string3
0x1a034400,
0x41004900,
0x53004800,
0x4f005500,
0x53004200,
0x30003000,
0x30000000,
# confunset
0x00000000,
# confset
0x01000000,
# eof
]

class USB3Descriptor(Module):
    def __init__(self):
        self.specials.mem = Memory(32, 128, init=usb3_descriptor)
        p = self.mem.get_port()
        self.specials += p
        self.ios = {p.adr, p.dat_r}

usb3_descrip = USB3Descriptor()
conv_output = verilog.convert(usb3_descrip, usb3_descrip.ios, name="usb3_descrip")
conv_output.write("usb3_descrip.v")
